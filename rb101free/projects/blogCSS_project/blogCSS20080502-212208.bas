  call setCSS  dim entries$(2, 999)  SUBJECT = 0 : TEXT = 1 : TIMESTAMP = 2  gosub [readEntriesFromDisk]  gosub [displayAll]  wait[displayAll]  cls  gosub [displayTitle]  gosub [displayLogInOut]  gosub [displayEntries]  return[displayTitle]  div title    print "Blogging Example"    div copyright      print "Copyright 2007, Shoptalk Systems"    end div  end div  return[displayLogInOut]  div links    if loggedIn then      link #newEntry, "New Entry", [newEntry]      print " ";      link #logOut, "Log out", [logOut]    else      link #logIn, "Log in", [logIn]    end if  end div  print ""  return[displayEntries]  div entries    print "Blog Entries": print      if lastEntry = 0 then        div entry          print "No entries."        end div      else        for entry = lastEntry - 1 to 0 step -1          gosub [displayEntry]          print        next entry      end if  end div  return[displayEntry]  div entry    print entries$(SUBJECT, entry); " - "; entries$(TIMESTAMP, entry)    print    print entries$(TEXT, entry)  end div  print  return[logIn]  cls  gosub [displayTitle]  div dialog    html "<h3>Log in</h3>"    print "User name: " : textbox #username, "" : print    print "Password: " : passwordbox #password, "" : print    link #accept, "Accept", [acceptLogin]  end div  print  if loginFailed then print "Invalid user name or password.  Try again."  wait[acceptLogin]  if #username contents$() = "foo" and #password contents$() = "bar" then    loginFailed = 0    loggedIn = 1  else    loginFailed = 1    goto [logIn]  end if  gosub [displayAll]  wait[logOut]  loggedIn = 0  gosub [displayAll]  wait[newEntry]  cls  gosub [displayTitle]  div dialog    print "New Entry"    print "Subject: " : textbox #subject, subject$ : print    print "Text:"    textarea #text, text$    print    link #acceptEntry, "Accept", [acceptEntry]    print " ";    link #cancelEntry, "Cancel", [cancelEntry]  end div  print  print errorNotice$  wait[acceptEntry]  subject$ = trim$(#subject contents$())  text$ = trim$(#text contents$())  if subject$ = "" then    errorNotice$ = "Subject field is empty."    goto [newEntry]      end if  if text$ = "" then    errorNotice$ = "Text area is empty."    goto [newEntry]      end if  errorNotice$ = ""  gosub [addEntry]  gosub [displayAll]  wait[cancelEntry]  errorNotice$ = ""  gosub [displayAll]  wait[addEntry]  entries$(TIMESTAMP, lastEntry) = date$()+", "+time$()  entries$(SUBJECT, lastEntry) = subject$  entries$(TEXT, lastEntry) = text$  subject$ = ""  text$ = ""  gosub [saveToDisk]  lastEntry = lastEntry + 1  gosub [displayAll]  return[saveToDisk]  open "blumberjack.dat" for random as #bj len = 5120  field #bj, 100 as subj$, 20 as ts$, 5000 as txt$   subj$ = entries$(SUBJECT, lastEntry)  ts$ = entries$(TIMESTAMP, lastEntry)  txt$ = entries$(TEXT, lastEntry)  put #bj, lastEntry+1  close #bj  return[readEntriesFromDisk]  open "blumberjack.dat" for random as #bj len = 5120  field #bj, 100 as subj$, 20 as ts$, 5000 as txt$   lastEntry = lof(#bj)/5120  if lastEntry > 0 then    for recNum = 1 to lastEntry      gettrim #bj, recNum      entries$(SUBJECT, recNum - 1) = subj$      entries$(TIMESTAMP, recNum - 1) = ts$      entries$(TEXT, recNum - 1) = txt$    next recNum  end if  close #bj  returnsub setCSS  cssid #title, "{ font-family: Tahoma; font-size: 20pt; font-weight: bold; background-repeat: no-repeat; background-image: url('http://localhost:8008/resources/electronicbanner.JPG') ; height: 80px}"  cssid #copyright, "{ font-size: 8pt }"  cssid #links, "{ font-family: Tahoma; background: #E8FFE8; padding: 4px; width: 792px }"  cssid #entries, "{ font-family: Tahoma; font-size: 16pt; background: #CFC; width: 768px; padding: 16px }"  cssid #entry, "{ font-family: Tahoma; font-size: 14pt; width: 700px; background: #FFF; border-bottom: 1px solid #CDC; }"  cssid #dialog, "{ font-family: Tahoma; background: #CFC; border-bottom: 1px solid #898; padding: 8px; width: 784px}"end sub